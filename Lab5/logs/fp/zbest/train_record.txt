args: Namespace(batch_size=24, beta=0.0001, beta1=0.9, cuda=True, data_root='./data', epoch_size=600, exp_name='b', g_dim=128, kl_anneal_cycle=4, kl_anneal_cyclical=True, kl_anneal_ratio=0.0, last_frame_skip=False, log_dir='./logs/fp/b', lr=0.002, model_dir='', n_eval=30, n_future=10, n_past=2, niter=150, num_workers=1, optimizer='adam', posterior_rnn_layers=1, predictor_rnn_layers=2, rnn_size=256, seed=1, tfr=1.0, tfr_decay_step=0.01, tfr_lower_bound=0.0, tfr_start_decay_epoch=15, z_dim=64)
[epoch: 00] loss: 0.00736 | mse loss: 0.00736 | kld loss: 89.26173
====================== validate psnr = 18.24178 ========================
[epoch: 01] loss: 0.03629 | mse loss: 0.01110 | kld loss: 0.47236
====================== validate psnr = 19.18681 ========================
[epoch: 02] loss: 0.00869 | mse loss: 0.00855 | kld loss: 0.00132
====================== validate psnr = 20.44779 ========================
[epoch: 03] loss: 0.00737 | mse loss: 0.00710 | kld loss: 0.00168
====================== validate psnr = 21.14512 ========================
[epoch: 04] loss: 0.00640 | mse loss: 0.00606 | kld loss: 0.00160
====================== validate psnr = 21.53115 ========================
[epoch: 05] loss: 0.00595 | mse loss: 0.00585 | kld loss: 0.00037
====================== validate psnr = 21.28574 ========================
[epoch: 06] loss: 0.00509 | mse loss: 0.00508 | kld loss: 0.00002
====================== validate psnr = 22.04528 ========================
[epoch: 07] loss: 0.00502 | mse loss: 0.00498 | kld loss: 0.00012
====================== validate psnr = 22.25164 ========================
[epoch: 08] loss: 0.00462 | mse loss: 0.00462 | kld loss: 0.00001
====================== validate psnr = 21.64999 ========================
[epoch: 09] loss: 0.00437 | mse loss: 0.00436 | kld loss: 0.00002
====================== validate psnr = 22.09269 ========================
[epoch: 10] loss: 0.00419 | mse loss: 0.00417 | kld loss: 0.00003
====================== validate psnr = 22.39127 ========================
[epoch: 11] loss: 0.00401 | mse loss: 0.00400 | kld loss: 0.00002
====================== validate psnr = 22.97295 ========================
[epoch: 12] loss: 0.00387 | mse loss: 0.00385 | kld loss: 0.00002
====================== validate psnr = 22.46436 ========================
[epoch: 13] loss: 0.00375 | mse loss: 0.00374 | kld loss: 0.00002
====================== validate psnr = 23.11589 ========================
[epoch: 14] loss: 0.00362 | mse loss: 0.00361 | kld loss: 0.00002
====================== validate psnr = 23.04440 ========================
[epoch: 15] loss: 0.00352 | mse loss: 0.00351 | kld loss: 0.00002
====================== validate psnr = 22.92173 ========================
[epoch: 16] loss: 0.00340 | mse loss: 0.00339 | kld loss: 0.00002
====================== validate psnr = 23.40653 ========================
[epoch: 17] loss: 0.00333 | mse loss: 0.00331 | kld loss: 0.00002
====================== validate psnr = 23.40765 ========================
[epoch: 18] loss: 0.00325 | mse loss: 0.00323 | kld loss: 0.00002
====================== validate psnr = 22.61195 ========================
[epoch: 19] loss: 0.00313 | mse loss: 0.00312 | kld loss: 0.00002
====================== validate psnr = 24.38532 ========================
[epoch: 20] loss: 0.00316 | mse loss: 0.00314 | kld loss: 0.00002
====================== validate psnr = 23.88292 ========================
[epoch: 21] loss: 0.00307 | mse loss: 0.00305 | kld loss: 0.00002
====================== validate psnr = 24.34843 ========================
[epoch: 22] loss: 0.00298 | mse loss: 0.00297 | kld loss: 0.00002
====================== validate psnr = 24.58308 ========================
[epoch: 23] loss: 0.00298 | mse loss: 0.00297 | kld loss: 0.00002
====================== validate psnr = 24.31736 ========================
[epoch: 24] loss: 0.00295 | mse loss: 0.00293 | kld loss: 0.00002
====================== validate psnr = 24.74168 ========================
[epoch: 25] loss: 0.00290 | mse loss: 0.00288 | kld loss: 0.00002
====================== validate psnr = 25.01976 ========================
[epoch: 26] loss: 0.00285 | mse loss: 0.00283 | kld loss: 0.00002
====================== validate psnr = 25.07305 ========================
[epoch: 27] loss: 0.00283 | mse loss: 0.00282 | kld loss: 0.00002
====================== validate psnr = 24.85427 ========================
[epoch: 28] loss: 0.00283 | mse loss: 0.00282 | kld loss: 0.00002
====================== validate psnr = 25.21265 ========================
[epoch: 29] loss: 0.00276 | mse loss: 0.00274 | kld loss: 0.00002
====================== validate psnr = 25.27753 ========================
[epoch: 30] loss: 0.00277 | mse loss: 0.00275 | kld loss: 0.00002
====================== validate psnr = 24.96025 ========================
[epoch: 31] loss: 0.00281 | mse loss: 0.00279 | kld loss: 0.00002
====================== validate psnr = 24.93350 ========================
[epoch: 32] loss: 0.00268 | mse loss: 0.00267 | kld loss: 0.00002
====================== validate psnr = 25.35563 ========================
[epoch: 33] loss: 0.00272 | mse loss: 0.00270 | kld loss: 0.00002
====================== validate psnr = 25.21307 ========================
[epoch: 34] loss: 0.00269 | mse loss: 0.00268 | kld loss: 0.00002
====================== validate psnr = 25.23375 ========================
[epoch: 35] loss: 0.00267 | mse loss: 0.00266 | kld loss: 0.00001
====================== validate psnr = 25.35227 ========================
[epoch: 36] loss: 0.00263 | mse loss: 0.00262 | kld loss: 0.00001
====================== validate psnr = 25.63218 ========================
[epoch: 37] loss: 0.00263 | mse loss: 0.00263 | kld loss: 19.10397
====================== validate psnr = 25.61315 ========================
[epoch: 38] loss: 0.02868 | mse loss: 0.00419 | kld loss: 0.45923
====================== validate psnr = 24.05589 ========================
[epoch: 39] loss: 0.00347 | mse loss: 0.00346 | kld loss: 0.00007
====================== validate psnr = 24.20692 ========================
[epoch: 40] loss: 0.00326 | mse loss: 0.00325 | kld loss: 0.00002
====================== validate psnr = 24.39868 ========================
[epoch: 41] loss: 0.00319 | mse loss: 0.00319 | kld loss: 0.00001
====================== validate psnr = 24.57044 ========================
[epoch: 42] loss: 0.00307 | mse loss: 0.00307 | kld loss: 0.00001
====================== validate psnr = 24.81594 ========================
[epoch: 43] loss: 0.00299 | mse loss: 0.00299 | kld loss: 0.00001
====================== validate psnr = 24.51342 ========================
[epoch: 44] loss: 0.00295 | mse loss: 0.00294 | kld loss: 0.00001
====================== validate psnr = 25.10390 ========================
[epoch: 45] loss: 0.00283 | mse loss: 0.00283 | kld loss: 0.00001
====================== validate psnr = 25.15218 ========================
[epoch: 46] loss: 0.00284 | mse loss: 0.00283 | kld loss: 0.00001
====================== validate psnr = 25.23990 ========================
[epoch: 47] loss: 0.00277 | mse loss: 0.00276 | kld loss: 0.00001
====================== validate psnr = 25.17569 ========================
[epoch: 48] loss: 0.00273 | mse loss: 0.00272 | kld loss: 0.00001
====================== validate psnr = 25.18005 ========================
[epoch: 49] loss: 0.00271 | mse loss: 0.00270 | kld loss: 0.00001
====================== validate psnr = 25.32775 ========================
[epoch: 50] loss: 0.00270 | mse loss: 0.00269 | kld loss: 0.00001
====================== validate psnr = 25.02624 ========================
[epoch: 51] loss: 0.00265 | mse loss: 0.00264 | kld loss: 0.00001
====================== validate psnr = 25.70058 ========================
[epoch: 52] loss: 0.00267 | mse loss: 0.00266 | kld loss: 0.00001
====================== validate psnr = 25.60436 ========================
[epoch: 53] loss: 0.00266 | mse loss: 0.00265 | kld loss: 0.00001
====================== validate psnr = 25.57967 ========================
[epoch: 54] loss: 0.00262 | mse loss: 0.00261 | kld loss: 0.00001
====================== validate psnr = 25.60692 ========================
[epoch: 55] loss: 0.00255 | mse loss: 0.00254 | kld loss: 0.00001
====================== validate psnr = 25.70978 ========================
[epoch: 56] loss: 0.00254 | mse loss: 0.00253 | kld loss: 0.00001
====================== validate psnr = 25.39593 ========================
[epoch: 57] loss: 0.00253 | mse loss: 0.00252 | kld loss: 0.00001
====================== validate psnr = 25.71222 ========================
[epoch: 58] loss: 0.00251 | mse loss: 0.00250 | kld loss: 0.00001
====================== validate psnr = 25.67147 ========================
[epoch: 59] loss: 0.00254 | mse loss: 0.00253 | kld loss: 0.00001
====================== validate psnr = 25.41969 ========================
[epoch: 60] loss: 0.00252 | mse loss: 0.00251 | kld loss: 0.00001
====================== validate psnr = 25.68031 ========================
[epoch: 61] loss: 0.00245 | mse loss: 0.00245 | kld loss: 0.00001
====================== validate psnr = 25.88741 ========================
[epoch: 62] loss: 0.00243 | mse loss: 0.00242 | kld loss: 0.00001
====================== validate psnr = 25.96232 ========================
[epoch: 63] loss: 0.00241 | mse loss: 0.00240 | kld loss: 0.00001
====================== validate psnr = 25.83656 ========================
[epoch: 64] loss: 0.00238 | mse loss: 0.00238 | kld loss: 0.00001
====================== validate psnr = 26.06960 ========================
[epoch: 65] loss: 0.00236 | mse loss: 0.00235 | kld loss: 0.00001
====================== validate psnr = 26.02586 ========================
[epoch: 66] loss: 0.00238 | mse loss: 0.00237 | kld loss: 0.00001
====================== validate psnr = 26.01493 ========================
[epoch: 67] loss: 0.00236 | mse loss: 0.00235 | kld loss: 0.00001
====================== validate psnr = 26.24357 ========================
[epoch: 68] loss: 0.00233 | mse loss: 0.00232 | kld loss: 0.00001
====================== validate psnr = 25.98853 ========================
[epoch: 69] loss: 0.00231 | mse loss: 0.00230 | kld loss: 0.00001
====================== validate psnr = 26.24299 ========================
[epoch: 70] loss: 0.00232 | mse loss: 0.00231 | kld loss: 0.00001
====================== validate psnr = 25.88885 ========================
[epoch: 71] loss: 0.00232 | mse loss: 0.00231 | kld loss: 0.00001
====================== validate psnr = 26.10230 ========================
[epoch: 72] loss: 0.00229 | mse loss: 0.00228 | kld loss: 0.00001
====================== validate psnr = 26.17555 ========================
[epoch: 73] loss: 0.00228 | mse loss: 0.00227 | kld loss: 0.00001
====================== validate psnr = 25.90898 ========================
[epoch: 74] loss: 0.00228 | mse loss: 0.00227 | kld loss: 0.00001
====================== validate psnr = 26.00145 ========================
[epoch: 75] loss: 0.00222 | mse loss: 0.00222 | kld loss: 7.87159
====================== validate psnr = 26.34344 ========================
[epoch: 76] loss: 0.01561 | mse loss: 0.00327 | kld loss: 0.23154
====================== validate psnr = 25.06205 ========================
[epoch: 77] loss: 0.00268 | mse loss: 0.00267 | kld loss: 0.00003
====================== validate psnr = 25.54199 ========================
[epoch: 78] loss: 0.00250 | mse loss: 0.00250 | kld loss: 0.00001
====================== validate psnr = 25.64967 ========================
[epoch: 79] loss: 0.00240 | mse loss: 0.00240 | kld loss: 0.00001
====================== validate psnr = 25.84427 ========================
[epoch: 80] loss: 0.00242 | mse loss: 0.00241 | kld loss: 0.00002
====================== validate psnr = 25.75057 ========================
[epoch: 81] loss: 0.00234 | mse loss: 0.00234 | kld loss: 0.00002
====================== validate psnr = 26.09281 ========================
[epoch: 82] loss: 0.00231 | mse loss: 0.00230 | kld loss: 0.00003
====================== validate psnr = 26.18840 ========================
[epoch: 83] loss: 0.00227 | mse loss: 0.00226 | kld loss: 0.00002
====================== validate psnr = 26.15003 ========================
[epoch: 84] loss: 0.00226 | mse loss: 0.00225 | kld loss: 0.00003
====================== validate psnr = 26.17420 ========================
[epoch: 85] loss: 0.00225 | mse loss: 0.00224 | kld loss: 0.00002
====================== validate psnr = 26.02779 ========================
[epoch: 86] loss: 0.00226 | mse loss: 0.00224 | kld loss: 0.00003
====================== validate psnr = 26.10891 ========================
[epoch: 87] loss: 0.00224 | mse loss: 0.00222 | kld loss: 0.00002
====================== validate psnr = 26.19986 ========================
[epoch: 88] loss: 0.00221 | mse loss: 0.00219 | kld loss: 0.00003
====================== validate psnr = 26.19664 ========================
[epoch: 89] loss: 0.00218 | mse loss: 0.00217 | kld loss: 0.00003
====================== validate psnr = 26.24226 ========================
[epoch: 90] loss: 0.00219 | mse loss: 0.00218 | kld loss: 0.00002
====================== validate psnr = 26.19818 ========================
[epoch: 91] loss: 0.00223 | mse loss: 0.00220 | kld loss: 0.00003
====================== validate psnr = 26.31574 ========================
[epoch: 92] loss: 0.00221 | mse loss: 0.00219 | kld loss: 0.00002
====================== validate psnr = 26.29556 ========================
[epoch: 93] loss: 0.00219 | mse loss: 0.00217 | kld loss: 0.00003
====================== validate psnr = 26.39715 ========================
[epoch: 94] loss: 0.00216 | mse loss: 0.00213 | kld loss: 0.00002
====================== validate psnr = 26.25695 ========================
[epoch: 95] loss: 0.00215 | mse loss: 0.00213 | kld loss: 0.00002
====================== validate psnr = 26.36084 ========================
[epoch: 96] loss: 0.00213 | mse loss: 0.00211 | kld loss: 0.00002
====================== validate psnr = 26.51737 ========================
[epoch: 97] loss: 0.00210 | mse loss: 0.00208 | kld loss: 0.00002
====================== validate psnr = 26.53826 ========================
[epoch: 98] loss: 0.00214 | mse loss: 0.00212 | kld loss: 0.00002
====================== validate psnr = 26.23823 ========================
[epoch: 99] loss: 0.00210 | mse loss: 0.00208 | kld loss: 0.00002
====================== validate psnr = 26.15736 ========================
[epoch: 100] loss: 0.00215 | mse loss: 0.00213 | kld loss: 0.00002
====================== validate psnr = 26.48981 ========================
[epoch: 101] loss: 0.00215 | mse loss: 0.00213 | kld loss: 0.00002
====================== validate psnr = 26.41576 ========================
[epoch: 102] loss: 0.00208 | mse loss: 0.00206 | kld loss: 0.00002
====================== validate psnr = 26.38262 ========================
[epoch: 103] loss: 0.00208 | mse loss: 0.00206 | kld loss: 0.00002
====================== validate psnr = 26.29721 ========================
[epoch: 104] loss: 0.00209 | mse loss: 0.00207 | kld loss: 0.00002
====================== validate psnr = 26.52993 ========================
[epoch: 105] loss: 0.00207 | mse loss: 0.00205 | kld loss: 0.00002
====================== validate psnr = 26.54039 ========================
[epoch: 106] loss: 0.00210 | mse loss: 0.00208 | kld loss: 0.00002
====================== validate psnr = 26.59469 ========================
[epoch: 107] loss: 0.00204 | mse loss: 0.00203 | kld loss: 0.00002
====================== validate psnr = 26.55380 ========================
[epoch: 108] loss: 0.00205 | mse loss: 0.00203 | kld loss: 0.00002
====================== validate psnr = 26.48941 ========================
[epoch: 109] loss: 0.00204 | mse loss: 0.00203 | kld loss: 0.00002
====================== validate psnr = 26.62783 ========================
[epoch: 110] loss: 0.00202 | mse loss: 0.00200 | kld loss: 0.00002
====================== validate psnr = 26.52093 ========================
[epoch: 111] loss: 0.00203 | mse loss: 0.00201 | kld loss: 0.00002
====================== validate psnr = 26.51989 ========================
[epoch: 112] loss: 0.00197 | mse loss: 0.00197 | kld loss: 9.92713
====================== validate psnr = 26.72130 ========================
[epoch: 113] loss: 0.01222 | mse loss: 0.00251 | kld loss: 0.18199
====================== validate psnr = 26.09506 ========================
[epoch: 114] loss: 0.00221 | mse loss: 0.00220 | kld loss: 0.00006
====================== validate psnr = 26.50556 ========================
[epoch: 115] loss: 0.00212 | mse loss: 0.00211 | kld loss: 0.00004
====================== validate psnr = 26.58751 ========================
[epoch: 116] loss: 0.00207 | mse loss: 0.00204 | kld loss: 0.00015
====================== validate psnr = 26.66030 ========================
[epoch: 117] loss: 0.00205 | mse loss: 0.00203 | kld loss: 0.00007
====================== validate psnr = 26.30129 ========================
[epoch: 118] loss: 0.00210 | mse loss: 0.00200 | kld loss: 0.00030
====================== validate psnr = 26.35059 ========================
[epoch: 119] loss: 0.00204 | mse loss: 0.00200 | kld loss: 0.00010
====================== validate psnr = 26.52898 ========================
